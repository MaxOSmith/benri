""" Utility functions for constructing summaries. """
from StringIO import StringIO

import matplotlib.pyplot as plt
import numpy as np
import tensorflow as tf


def scalar(tag, value):
    """ Construct a scalar summary.

    :param tag: Name of the scalar.
    :param value: Scalar value.
    """
    summary = tf.Summary.Value(tag=tag, simple_value=value)
    summary = tf.Summary(value=summary)
    return summary


def image(tag, image):
    """

    :param tag: Name of the scalar.
    :param image: Image [H, W, C].
    """
    # Write the image to a string.
    s = StringIO()
    plt.imsave(s, image, format="png")

    image_summary = tf.Summary.Image(
        encoded_image_strng=s.getvalue(),
        height=image.shape[0],
        width=image.shape[1])

    summary = tf.Summary.Value(tag=tag, image=summary)
    summary = tf.Summary(value=summary)
    return summary
